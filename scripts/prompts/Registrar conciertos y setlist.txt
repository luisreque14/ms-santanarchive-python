Tengo un excel que registra les fechas de concierto y las canciones tocadas en cada concierto. Estas son las columnas:

Fecha: fecha del concierto en formato día/mes/año (obligatorio)
Venue: lugar del concierto (obligatorio)
Tipo de Concierto: tipo de concierto (obligatorio)
Tipo de Lugar: tipo de lugar (obligatorio)
Tour: nombre del tour (puede estar vacío)
Ciudad: ciudad en donde se realizó (obligatorio)
Código Estado: código de estado de la ciudad (solo si es United States y Canada)
Nombre Estado: nombre del estado de la ciudad (solo si es United States y Canada)
País: país (obligatorio)
Continente: continente (obligatorio)
Canción: nombre de la canción.
Artista Invitado: nombre del artista invitado en la canción. Pueden ser varios artistas y, en ese caso, están separados por ","
Es Cover?: "SI": si es un conver, caso contrario "NO"
Cover Song: nombre de la canción cover

La estructura que quiero crear en MongoDB (Atlas) es la siguiente:

Colección "concert_types":
-concert_type_id: correlativo. Tipo Int, Obligatorio.
-concert_type_name: columna "Tipo de Concierto". Tipo String, Obligatorio.

Colección "venue_types":
-venue_type_id: correlativo. Tipo Int, Obligatorio.
-venue_type_name: columna "Tipo de Lugar". Tipo String, Obligatorio.

Colección "tours":
-tour_id: correlativo. Tipo Int, Obligatorio.
-tour_name: columna "Tour". Tipo String, Obligatorio.

Colección "venues":
-venue_date: columna "Fecha". Tipo Date, Obligatorio.
-venue_name: columna "Venue". Tipo String, Obligatorio.
-venue_type_id: referencia a venue_type_id de "venue_types". Tipo Int, Obligatorio.
-concert_type_id: referencia a concert_type_id de "concert_types". Tipo Int, Obligatorio.
-tour_id: referencia a tour_id de "tours". Tipo Int, Opcional.
-city_id: referencia a city_id de "cities". Tipo Int, Obligatorio.
-song_count: cantidad de canciones relacionadas en "venue_songs". Tipo Int, Obligatorio. Si no hay, el valor es cero.
-venue_year: año de venue_date.

Coleccion "guest_artists_venues"
-guest_artist_venue_id: correlativo. Tipo Int, Obligatorio.
-guest_artist_name: columna "Artista Invitado". Tipo String, Obligatorio.

Colección "venue_songs":
-venue_id: id de venue. Tipo Int, Obligatorio.
-song_name: columna "Canción". Tipo String, Obligatorio.
-guest_artist_ids: lista con ids de referencia a guest_artist_venue_id de "guest_artists_venues". Opcional pero el atributo debe existir con una lista vacía de tipo Int.
-track_ids: lista con ids de referencia a id de "tracks". Opcional pero el atributo debe existir con una lista vacía de tipo Int.
-is_cover: Si columna "Es Cover?" es "SI", true, sino, false. Tipo Boolean, Obligatorio.


Crea un programa en Python para que lea el Excel y realice el registro según las siguientes instrucciones:

1. Cada línea representa una canción por concierto (venue), por lo cual, se debe leer la primera línea de cada concierto para registrar el venue de esta manera:
	1.1. En colección concert_types: buscar si el campo de "Tipo de Concierto" existe en concert_type_name. Si no existe, crea un documento en concert_types y obtiene el id.
	1.2. En colección venue_types: buscar si el campo de "Tipo de Lugar" existe en venue_type_name. Si no existe, crea un documento en venue_types y obtiene el id.
	1.3. En colección tours: buscar si el campo de "Tour" existe en tour_name, siempre y cuando no esté vacío. Si no existe, crea un documento en tours y obtiene el id.
	1.4. En colección cities: buscar si el campo de "Ciudad" existe en name. Si no existe, verificar lo siguiente:
		1.4.1. Si el campo de "Código de Estado" está vacío, verificar lo siguiente:
			-Si el campo de "País" existe en la colección "countries" (por name), obtiene el id de "countries". Si no existe, verificar lo siguiente:
				-Buscar el campo "Continente" en la colección "continents" (por name), obtiene el id de "continents".
				-Registra el nuevo country ("País" en "name", null en "code" y el id de continent obtenido en "continent_id") y devuelve el id.
				-Registra el nuevo city con el null en "state_id", el id de country en "country_id", null en "code" y "Ciudad" en "name".
		1.4.2. Si el campo de "Código Estado" no está vacío, busca en la colección "states" (por code) y por "País" (en countries, campo "name"), si existe, obtiene el id. 
			-Si no existe, verificar si campo de "País" existe en la colección "countries" (por name), obtiene el id de "countries". Si no existe, verificar lo siguiente:
				-Buscar el campo "Continente" en la colección "continents" (por name), obtiene el id de "continents".
				-Registra el nuevo country ("País" en "name", null en "code" y el id de continent obtenido en "continent_id") y devuelve el id.
				-Registra el nuevo state ("Código Estado" en "code", "Nombre Estado" en "name" y el id de country obtenido en "country_id") y devuelve el id.
				-Registra el nuevo city con el id de state en "state_id", el id de country en "country_id", null en "code" y "Ciudad" en "name".
	1.5. El orden del ubigeo es ciudad -> estado(opcional) -> país -> continente.
	1.6. En la colección venues: crea un documento con el campo de "Venue" (venue_name) y los ids obtenidos de concert_types, venue_types, tours y cities.

2. Para registrar las canciones tocadas en cada venue en "venue_songs", hacer lo siguiente:
	Si el campo "Canción" está vacío, no registrar nada en venue_songs.
	Caso contrario:
		-En guest_artists_venues: buscar el campo "Artista Invitado" en guest_artist_name. Si no existe, crea un documento en guest_artists_venues y obtiene el id.
		-En venue_songs: crea un documento con el campo de "Canción" en song_name (si está vacío, registrar null), el id de "venues" (paso 1), los ids registrados en guest_artists_venues (si no hay ningun, se registra una lista vacía) y si el campo "Es Cover?" es "SI", true, sino, false.
		-Partir el "Canción" por "/" y buscar cada canción en la colección "tracks" por el campo "title". Si la canción del venue existe en "tracks", obtener el id de referencia y registrarlo en track_ids.
		
3. Todos los campos de las colecciones descritas al inicio deben existir. Si no se detecta algún valor, establecerlo en null.

4. Se deben usar los ids de las colecciones existentes para referenciar a venues.

5. Manejar logs para los siguientes casos:
	-Si alguno de los campos del Excel que son "obligatorio" están vacíos, indicar en el log con el campo o campos que faltan y no continuar con el registro venue.
	
6. El excel a leer tiene casi 47000 filas, por lo cual, para validar los datos en las colecciones existentes, es mejor obtener todo en memoria y evitar hacerlo uno por uno.

7. Aplica trim a todos los datos y, para las comparaciones, no hacer distinciones entre mayúsculas y minúsculas.

8. El programa debe ser idempotente. La llave del Excel es "Fecha", "Venue" y "Ciudad". Cada vez que lo ejecute, debe registrar lo que no existe, ya que, contínuamente actualizaré el Excel con más fechas de conciertos.


Esta es la colección de continents, countries, states, cities y tracks:

continents
{
  "_id": {
    "$oid": "6963429f4a4eb4e01b7e2fe8"
  },
  "id": 1,
  "code": "AM",
  "name": "America"
}

countries
{
  "_id": {
    "$oid": "696353fbd5094354f2c9aebd"
  },
  "id": 1,
  "code": "AW",
  "continent_id": 1,
  "name": "Aruba"
}

states
{
  "_id": {
    "$oid": "69636bdb2cb191a4c26afd6c"
  },
  "id": 151,
  "country_id": 235,
  "code": "AL",
  "name": "Alabama"
}

cities
{
  "_id": {
    "$oid": "696373b7419ab720b9a01228"
  },
  "id": 0,
  "country_id": 176,
  "state_id": null,
  "code": "LIM",
  "name": "Lima"
}

{
  "_id": {
    "$oid": "69640b8b9553d69017fb8e29"
  },
  "album_id": 1,
  "title": "Waiting",
  "composer_ids": [
    1
  ],
  "duration": "00:04:07",
  "genre_ids": [
    49,
    38
  ],
  "metadata": {
    "key": "Gm",
    "is_instrumental": true,
    "is_live": false,
    "is_love_song": false
  },
  "side": "A",
  "track_number": 1,
  "guest_artist_ids": [],
  "guest_lead_vocal_ids": [],
  "lead_vocal_ids": [],
  "duration_seconds": 247
}

----------------------------------------------------------------------

Tengo un excel que registra les fechas de concierto y las canciones tocadas en cada concierto. Estas son las columnas:

Fecha: fecha del concierto en formato día/mes/año (obligatorio)
Venue: lugar del concierto (obligatorio)
Tipo de Concierto: tipo de concierto (obligatorio)
Tipo de Lugar: tipo de lugar (obligatorio)
Tour: nombre del tour (puede estar vacío)
Ciudad: ciudad en donde se realizó (obligatorio)
Estado: estado de la ciudad (solo si es United States)
País: país
Canción: nombre de la canción. Puede que se mezclen 2 canciones, en ese caso, cada canción se separa con "/"
Artista Invitado: nombre del artista invitado en la canción. Pueden ser varios artistas y, en ese caso, están separados por ","
Es Cover?: "SI": si es un conver, caso contrario "NO"
Cover Song: nombre de la canción cover

El excel tiene casi 47000 filas y no quiero revisar los datos repetidos manualmente.
Crea un programa en Python que detecte si hay datos inconsistenes considerando lo siguiente:
	-Cada línea representa una canción (Canción) por concierto (Venue), por lo cual, se debe leer la primera línea de cada concierto para obtener el venue.
	-La llave de un venue es: Fecha, Venue, Tipo de Concierto, Tipo de Lugar, Tour, Ciudad, Estado y País.
	-Cada línea dentro de un venue, tiene las canciones tocadas. Por eso, en Excel se repite la llave del venue.
	-Los datos que quiero revisar son los siguientes:
		A nivel de "Fecha"-"Venue":
			Columna "Tipo de Concierto": para saber si un mismo venue tiene tipos diferentes.
			Columna "Tipo de Lugar": para saber si un mismo venue tiene tipos de lugar diferentes.
			Columna "Tour": para saber si un mismo venue tiene tours diferentes.
			Columna "Ciudad": para saber si un mismo venue tiene ciudades diferentes.
			Columna "Estado": para saber si un mismo venue tiene estados diferentes.
			Columna "País": para saber si un mismo venue tiene países diferentes.
Muestra un log de aquellos venues en los que no tienen la data correcta según lo anterior.


	



