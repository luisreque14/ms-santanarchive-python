Tengo un excel que registra las fechas de concierto y las canciones tocadas en cada concierto. Estas son las columnas:

Fecha: fecha del concierto en formato (a√±o/mes/d√≠a) (obligatorio)
Venue: lugar del concierto (obligatorio)
Tipo de Funci√≥n: Early, Late o Unique  (obligatorio)
Hora Funci√≥n: hora de la funci√≥n (opcional)
Tipo de Concierto: tipo de concierto (obligatorio)
Tipo de Lugar: tipo de lugar (obligatorio)
Tour: nombre del tour (puede estar vac√≠o)
Ciudad: ciudad en donde se realiz√≥ (obligatorio)
C√≥digo Estado: c√≥digo de estado de la ciudad (solo si es United States y Canada)
Nombre Estado: nombre del estado de la ciudad (solo si es United States y Canada)
Pa√≠s: pa√≠s (obligatorio)
Continente: continente (obligatorio)
Canci√≥n: nombre de la canci√≥n (opcional)
Artista Invitado: nombre del artista invitado en la canci√≥n. Pueden ser varios artistas y, en ese caso, est√°n separados por "," (opcional)
Es Cover?: "VERDADERO": si es un conver, caso contrario "FALSE" (obligatorio)
Cover Song: nombre de la canci√≥n cover (opcional)

La estructura que quiero crear en MongoDB (Atlas) es la siguiente:

Colecci√≥n "show_types":
-show_type_id: correlativo. Tipo Int, Obligatorio.
-show_type_name: columna "Tipo de Funci√≥n". Tipo String, Obligatorio.

Colecci√≥n "concert_types":
-concert_type_id: correlativo. Tipo Int, Obligatorio.
-concert_type_name: columna "Tipo de Concierto". Tipo String, Obligatorio.

Colecci√≥n "venue_types":
-venue_type_id: correlativo. Tipo Int, Obligatorio.
-venue_type_name: columna "Tipo de Lugar". Tipo String, Obligatorio.

Colecci√≥n "tours":
-tour_id: correlativo. Tipo Int, Obligatorio.
-tour_name: columna "Tour". Tipo String, Obligatorio.

Colecci√≥n "concerts":
-id: correlativo num√©rico. Usar la colecci√≥n "counters" para crear una secuencia venue_id (en caso no exista).
-concert_date: columna "Fecha" y "Hora Funci√≥n". Tipo Timestamp, Obligatorio.
-concert_date_str: columna "Fecha". Tipo string (ser√° la fecha en formato a√±o/mes/d√≠a), Obligatorio.
-venue_name: columna "Venue". Tipo String, Obligatorio.
-venue_type_id: referencia a venue_type_id de "venue_types". Tipo Int, Obligatorio.
-show_type_id: referencia a show_type_id de "show_types". Tipo Int, Obligatorio.
-show_time: columna "Hora Funci√≥n". Tipo string, opcional.
-concert_type_id: referencia a concert_type_id de "concert_types". Tipo Int, Obligatorio.
-tour_id: referencia a tour_id de "tours". Tipo Int, Opcional.
-city_id: referencia a id de "cities". Tipo Int, Obligatorio.
-state_id: referencia a state_id de "cities". Tipo Int, Opcional.
-country_id: referencia a country_id de "cities". Tipo Int, Obligatorio.
-continent_id: referencia a continent_id de "countries". Tipo Int, Obligatorio.
-song_count: cantidad de canciones relacionadas en "concert_songs". Tipo Int, Obligatorio. Si no hay, el valor es cero.
-concert_year: a√±o de concert_date.

Coleccion "guest_artists_concerts"
-guest_artist_concert_id: correlativo. Tipo Int, Obligatorio.
-guest_artist_name: columna "Artista Invitado". Tipo String, Obligatorio.

Colecci√≥n "concert_songs":
-concert_id: id de concert. Tipo Int, Obligatorio.
-song_number: correlativo por concert_id. Empieza en 1 hasta el N, seg√∫n la cantidad de canciones dentro de un concert_id. Tipo Int, Obligatorio
-song_name: columna "Canci√≥n". Tipo String, Obligatorio.
-guest_artist_ids: lista con ids de referencia a guest_artist_concert_id de "guest_artists_concerts". Opcional pero el atributo debe existir con una lista vac√≠a de tipo Int.
-track_ids: lista con ids de referencia a id de "tracks". Opcional pero el atributo debe existir con una lista vac√≠a de tipo Int.
-is_cover: Si columna "Es Cover?" es "SI", true, sino, false. Tipo Boolean, Obligatorio.


Crea un programa en Python para que lea el Excel y realice el registro seg√∫n las siguientes instrucciones:

1. La fecha puede estar en formato a√±o/mes/d√≠a o d√≠a/mes/a√±o. Si no es as√≠, indicar en un log y continuar con la siguiente fila del Excel.
  1.1. Si el campo "Hora" no est√° vac√≠o, concatenar el campo "Fecha" con "Hora". Caso contrario, solo considerar el campo "Fecha".
  1.2. Convertir la concatenaci√≥n para registrarlo en "concert_date" como tipo TimeStamp y en  "concert_date_str" como texto en formato a√±o/mes/d√≠a Hora:minutos:segundos

2. Cada l√≠nea representa una canci√≥n por concierto (concert), por lo cual, se debe leer la primera l√≠nea de cada concierto para registrar el venue de esta manera:
	2.1. En colecci√≥n concert_types: buscar si el campo de "Tipo de Concierto" existe en concert_type_name. Si no existe, crea un documento en concert_types y obtiene el id.
	2.2. En colecci√≥n venue_types: buscar si el campo de "Tipo de Lugar" existe en venue_type_name. Si no existe, crea un documento en venue_types y obtiene el id.
	2.3. En colecci√≥n tours: buscar si el campo de "Tour" existe en tour_name, siempre y cuando no est√© vac√≠o. Si no existe, crea un documento en tours y obtiene el id.
	2.4. En colecci√≥n cities: buscar si el campo de "Ciudad" existe en name. Si no existe, verificar lo siguiente:
		2.4.1. Si el campo de "C√≥digo de Estado" est√° vac√≠o, verificar lo siguiente:
			-Si el campo de "Pa√≠s" existe en la colecci√≥n "countries" (por name), obtiene el id de "countries". Si no existe, verificar lo siguiente:
				-Buscar el campo "Continente" en la colecci√≥n "continents" (por name), obtiene el id de "continents".
				-Registra el nuevo country ("Pa√≠s" en "name", null en "code" y el id de continent obtenido en "continent_id") y devuelve el id.
        -El id del country se obtiene de la colecci√≥n counters id: "country_id", campo sequence_value
				-Registra el nuevo city con el null en "state_id", el id de country en "country_id", null en "code" y "Ciudad" en "name".
        -El id del city se obtiene de la colecci√≥n counters id: "city_id", campo sequence_value
		2.4.2. Si el campo de "C√≥digo Estado" no est√° vac√≠o, busca en la colecci√≥n "states" (por code) y por "Pa√≠s" (en countries, campo "name"), si existe, obtiene el id. 
			-Si no existe, verificar si campo de "Pa√≠s" existe en la colecci√≥n "countries" (por name), obtiene el id de "countries". Si no existe, verificar lo siguiente:
				-Buscar el campo "Continente" en la colecci√≥n "continents" (por name), obtiene el id de "continents".
				-Registra el nuevo country ("Pa√≠s" en "name", null en "code" y el id de continent obtenido en "continent_id") y devuelve el id.
        -El id del country se obtiene de la colecci√≥n counters id: "country_id", campo sequence_value
				-Registra el nuevo state ("C√≥digo Estado" en "code", "Nombre Estado" en "name" y el id de country obtenido en "country_id") y devuelve el id.
        -El id del state se obtiene de la colecci√≥n counters id: "state_id", campo sequence_value
				-Registra el nuevo city con el id de state en "state_id", el id de country en "country_id", null en "code" y "Ciudad" en "name".
        -El id del city se obtiene de la colecci√≥n counters id: "city_id", campo sequence_value
    2.4.3. Pueden haber ciudades con el mismo nombre pero con diferente pa√≠s en la BD, por lo tanto, en caso de encontrar m√°s de una ciudad, se debe hacer lo siguiente:
      -Buscar el campo pa√≠s "Pa√≠s" en la colecci√≥n "countries" (por name).
      -Obtener el id de pa√≠s y filtrar las ciudades encontradas por dicho id (country_id)
  2.5. El orden del ubigeo es ciudad -> estado(opcional) -> pa√≠s -> continente.
	2.6. En la colecci√≥n concerts: crea un documento con el campo de "Venue" (venue_name) y los ids obtenidos de concert_types, venue_types, tours y cities.

3. Para registrar las canciones tocadas en cada concert en "concert_songs", hacer lo siguiente:
	Si el campo "Canci√≥n" est√° vac√≠o, no registrar nada en concert_songs.
	Caso contrario:
		-En guest_artists_concerts: buscar el campo "Artista Invitado" en guest_artist_name. Si no existe, crea un documento en guest_artists_concerts y obtiene el id.
		-Partir el campo "Artista Invitado" por "," y buscar, de manera independiente, cada parte (split) en la colecci√≥n "guest_artists_concerts" por el campo "guest_artist_name". Si el guest_artist del concert existe en "guest_artists_concerts", obtener el id de referencia y registrarlo en guest_artist_ids.
		-En concert_songs: crea un documento con el campo de "Canci√≥n" en song_name (si est√° vac√≠o, registrar null), el id de "concerts" (paso 1), los ids registrados en guest_artists_concerts (si no hay ninguno, se registra una lista vac√≠a) y si el campo "Es Cover?" es "VERDADERO", true, sino, false.
		-Partir el campo "Canci√≥n" por " / " (solo considerar que "/" est√© en medio de espacios en blanco) y buscar, de manera independiente, cada parte (split) en la colecci√≥n "tracks" por el campo "title" sin distinguir may√∫sculas ni min√∫sculas. Si la canci√≥n del concert existe en "tracks", obtener el id de referencia y registrarlo en track_ids.
      Ejemplo:
        Caso A: "Black Magic Woman / Gypsy Queen" -> Buscar "Black Magic Woman" y luego "Gypsy Queen".
        Caso B: "AC/DC" -> No se parte (porque no hay espacios).
    -Si una canci√≥n se parte en dos, ambas deben mantener los mismos guest_artist_ids y el mismo is_cover de esa fila del Excel.

4. Todos los campos de las colecciones descritas al inicio deben existir. Si no se detecta alg√∫n valor, establecerlo en null.

5. Se deben usar los ids de las colecciones existentes para referenciar a concerts.

6. Manejar logs para los siguientes casos:
	-Si alguno de los campos del Excel que son "obligatorio" est√°n vac√≠os, indicar en el log con el campo o campos que faltan y no continuar con el registro venue.
	
7. El excel a leer tiene casi 47000 filas, por lo cual, para validar los datos en las colecciones existentes, es mejor obtener todo en memoria y evitar hacerlo uno por uno.

8. Aplica trim a todos los datos y, para las comparaciones, no hacer distinciones entre may√∫sculas y min√∫sculas.

9. El programa debe ser idempotente. La llave del Excel es "Fecha", "Venue", "Tipo de Funci√≥n" y "Ciudad". 
  9.1. Cada vez que lo ejecute, debe registrar lo que no existe.
  9.2. Para los concerts existentes: 
    -Eliminar los concert_songs existentes y reemplazar por una nueva lista seg√∫n el Excel.
    -Actualizar estos campos venue_type_id, show_type_id, show_time, concert_type_id, tour_id, state_id, country_id.

10. Debe haber logs para lo siguiente:
  10.1. Indicar si el concierto ya existe, con √≠cono üÜï
  10.2. Indicar si el concierto existe y se va a actualizar, con √≠cono ‚úÖ
  10.3. Indicar si la fecha es incorrecta, con √≠cono ‚ö†Ô∏è
  10.4. Indicar si los campos obligatorios no est√°n completos, con √≠cono ‚ö†Ô∏è
  10.5. Indicar si el proceso termin√≥, con √≠cono üèÅ
  10.6. Cualquier otro error que puedas preveer debe tener un mensaje con √≠cono ‚ö†Ô∏è

11. En MongoDB existe una colecci√≥n counters que podr√≠a usarse para los IDs num√©ricos, esta es la estructura:

{
  "_id": "state_id",
  "sequence_value": 213
}

{
  "_id": "country_id",
  "sequence_value": 250
}

{
  "_id": "city_id",
  "sequence_value": 144
}

Esta es la colecci√≥n de continents, countries, states, cities y tracks:

continents
{
  "_id": {
    "$oid": "6963429f4a4eb4e01b7e2fe8"
  },
  "id": 1,
  "code": "AM",
  "name": "America"
}

countries
{
  "_id": {
    "$oid": "696353fbd5094354f2c9aebd"
  },
  "id": 1,
  "code": "AW",
  "continent_id": 1,
  "name": "Aruba"
}

states
{
  "_id": {
    "$oid": "69636bdb2cb191a4c26afd6c"
  },
  "id": 151,
  "country_id": 235,
  "code": "AL",
  "name": "Alabama"
}

cities
{
  "_id": {
    "$oid": "696373b7419ab720b9a01228"
  },
  "id": 0,
  "country_id": 176,
  "state_id": null,
  "code": "LIM",
  "name": "Lima"
}

tracks:
{
  "_id": {
    "$oid": "69640b8b9553d69017fb8e29"
  },
  "id": 1,
  "album_id": 1,
  "title": "Waiting",
  "composer_ids": [
    1
  ],
  "duration": "00:04:07",
  "genre_ids": [
    49,
    38
  ],
  "metadata": {
    "key": "Gm",
    "is_instrumental": true,
    "is_live": false,
    "is_love_song": false
  },
  "side": "A",
  "track_number": 1,
  "guest_artist_ids": [],
  "guest_lead_vocal_ids": [],
  "lead_vocal_ids": [],
  "duration_seconds": 247
}

----------------------------------------------------------------------

Tengo un excel que registra les fechas de concierto y las canciones tocadas en cada concierto. Estas son las columnas:

Fecha: fecha del concierto en formato d√≠a/mes/a√±o (obligatorio)
Venue: lugar del concierto (obligatorio)
Tipo de Concierto: tipo de concierto (obligatorio)
Tipo de Lugar: tipo de lugar (obligatorio)
Tour: nombre del tour (puede estar vac√≠o)
Ciudad: ciudad en donde se realiz√≥ (obligatorio)
Estado: estado de la ciudad (solo si es United States)
Pa√≠s: pa√≠s
Canci√≥n: nombre de la canci√≥n. Puede que se mezclen 2 canciones, en ese caso, cada canci√≥n se separa con "/"
Artista Invitado: nombre del artista invitado en la canci√≥n. Pueden ser varios artistas y, en ese caso, est√°n separados por ","
Es Cover?: "SI": si es un conver, caso contrario "NO"
Cover Song: nombre de la canci√≥n cover

El excel tiene casi 47000 filas y no quiero revisar los datos repetidos manualmente.
Crea un programa en Python que detecte si hay datos inconsistenes considerando lo siguiente:
	-Cada l√≠nea representa una canci√≥n (Canci√≥n) por concierto (Concert), por lo cual, se debe leer la primera l√≠nea de cada concierto para obtener el venue.
	-La llave de un concert es: Fecha, Venue, Tipo de Concierto, Tipo de Lugar, Tour, Ciudad, Estado y Pa√≠s.
	-Cada l√≠nea dentro de un concert, tiene las canciones tocadas. Por eso, en Excel se repite la llave del concert.
	-Los datos que quiero revisar son los siguientes:
		A nivel de "Fecha"-"Concert":
			Columna "Tipo de Concierto": para saber si un mismo concert tiene tipos diferentes.
			Columna "Tipo de Lugar": para saber si un mismo concert tiene tipos de lugar diferentes.
			Columna "Tour": para saber si un mismo concert tiene tours diferentes.
			Columna "Ciudad": para saber si un mismo concert tiene ciudades diferentes.
			Columna "Estado": para saber si un mismo concert tiene estados diferentes.
			Columna "Pa√≠s": para saber si un mismo concert tiene pa√≠ses diferentes.
Muestra un log de aquellos concerts en los que no tienen la data correcta seg√∫n lo anterior.


	



